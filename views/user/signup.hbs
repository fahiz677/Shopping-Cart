
<section>
    <div class="px-4 py-5 px-md-5 text-center text-lg-start" style="background-color: hsl(0, 0%, 100%)">
        <div class="container mt-5">
            <div class="row gx-lg-5 align-items-center mt-5">
                <div class="col-lg-6 mb-5 mb-lg-0">
                    <h1 class="my-5 display-3 fw-bold ls-tight">
                        Create new Account<br />
                        <span class="text-primary display-3">Quick and free sign up</span>
                    </h1>
                    <p style="color: hsl(217, 10%, 50.8%)">
                    </p>
                </div>

                <div class="col-lg-6 mb-5 mb-lg-0">
                    <div class="card">
                        <div class="card-body py-5 px-md-5">

                            <form action="/signup" method="post">
                                <div class="row align-items-center">
                                    <div class="col-md-12 mb-2">
                                        <div class="divider d-flex justify-content-center align-items-center my-4">
                                            <h3 class="text-center fw-bold mx-3 mb-0">Sign up</h3>
                                        </div>
                                    </div>
                                    
                                    {{!-- User Exist Display --}}
                                    <div class="col-12 text-center" id="existError"></div>

                                    <div class="col-md-6 mb-2">
                                        <div class="form-outline ">
                                            <p id="input_valid"></p>
                                            <input type="text" name="firstName" id="fName" placeholder="First name"
                                                class="form-control" />
                                            <label class="form-label" for="form3Example1">First name</label>
                                        </div>
                                    </div>

                                    <div class="col-md-6 mb-2">
                                        <div class="form-outline">
                                            <p id="input_valid"></p>
                                            <input type="text" id="lName" name="lastName" placeholder="Last name"
                                                class="form-control" />
                                            <label class="form-label" for="form3Example2">Last name</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="form-outline mb-2 input-cont">
                                    <p id="input_valid"></p>
                                    <input type="text" id="email" name="email" placeholder="Email address"
                                        class="form-control" />
                                    <label class="form-label" for="form3Example3">Email</label>
                                </div>

                                <div class="form-outline mb-4 input-cont">
                                    <p id="input_valid"></p>
                                    <input type="password" id="password" name="password" placeholder="Password"
                                        class="form-control" />
                                    <label class="form-label" for="form3Example4">Password</label>
                                </div>

                                <div class="form-outline mb-4 input-cont">
                                    <p id="input_valid"></p>
                                    <input type="password" id="confirmPassword" name="password"
                                        placeholder="Confirm Password" class="form-control" />
                                    <label class="form-label" for="form3Example4">Confirm Password</label>
                                </div>

                                <!-- Submit button -->
                                <button type="button" onclick="validator()" class="btn btn-primary btn-block mb-4 "
                                    id="submit_btn">
                                    Sign up
                                </button>
                                <div class=" text-center text-lg-start mt-0 pt-2">
                                    <p class="small fw-bold mt-2 pt-1 mb-0">Already have an account? <a href="/login"
                                            class="link-danger">Click here</a></p>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script>

    function validator() {

        let fName = document.getElementById('fName')
        let lName = document.getElementById('lName')
        let email = document.getElementById('email')
        let password = document.getElementById('password')
        let confirmPassword = document.getElementById('confirmPassword')

        let fNameValue = fName.value.trim()
        let lNameValue = lName.value.trim()
        let emailValue = email.value.trim()
        let passwordValue = password.value.trim()
        let confirmPasswordValue = confirmPassword.value.trim()


        let flag = 1

        var error1 = fName.parentElement.querySelector('p')
        var error2 = lName.parentElement.querySelector('p')
        var error3 = email.parentElement.querySelector('p')
        var error4 = password.parentElement.querySelector('p')
        var error5 = confirmPassword.parentElement.querySelector('p')

        error1.innerText = ""
        error2.innerText = ""
        error3.innerText = ""
        error4.innerText = ""
        error5.innerText = ""

        if (fNameValue == "") {

            error1.innerText = 'This field is required'
            error1.style.color = 'rgb(255, 104, 104)'
            flag = 2

        }
        else if (fNameValue.length < 2) {

            error1.innerText = 'First Name must be minimum 2 characters or more'
            error1.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        else if (!fNameValue.match(/^[a-zA-Z]*$/)) {

            error1.innerText = 'Character must be a letter'
            error1.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        if (lNameValue == "") {

            error2.innerText = 'This field is required'
            error2.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        else if (lNameValue.length < 2) {

            error2.innerText = 'Last Name must be minimum 2 characters or more'
            error2.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        else if (!lNameValue.match(/^[a-zA-Z]*$/)) {

            error2.innerText = 'Character must be a letter'
            error2.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        if (emailValue == "") {

            error3.innerText = 'This field is required'
            error3.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        else if (!emailValue.match(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/)) {

            error3.innerText = 'Enter a valid email'
            error3.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        if (passwordValue == "") {

            error4.innerText = 'This field is required'
            error4.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        else if (passwordValue.length < 8) {

            error4.innerText = 'Password must be minimum 8 characters'
            error4.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        if (confirmPasswordValue == "") {

            error5.innerText = 'This field is required'
            error5.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }
        else if (confirmPasswordValue !== passwordValue) {

            error5.innerText = 'Entered value must be same as password'
            error5.style.color = 'rgb(255, 104, 104)'
            flag = 2
        }

        if (flag == 1) {
            submit(fNameValue, lNameValue, emailValue, passwordValue)
        }

    }
    function submit(fName, lName, email, password) {
        fetch('/signup', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',

            },
            body: JSON.stringify({
                firstName: fName,
                lastName: lName,
                email: email,
                password: password

            })

        })
            .then((res) => res.json())
            .then((res) => {

                if (res.ll == "Login Successful") {
                    setTimeout(() => {
                        window.location.href = '/'
                    }, 500)

                    var existError = document.getElementById('existError')
                    existError.innerText = res.ll
                    existError.style.color = "rgb(35 148 46)"

                }
                else {
                    var existError = document.getElementById('existError')
                    existError.innerText = res.ll
                    existError.style.color = "rgb(255, 104, 104)"
                }
            })
    }

</script>